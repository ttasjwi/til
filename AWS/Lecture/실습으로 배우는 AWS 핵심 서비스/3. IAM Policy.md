

## AWS IAM (Identity and Access Management)
- 공식 문서 : [aws doc](https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/introduction.html)
- AWS **리소스**에 대한 **액세스**를 안전하게 제어할 수 있는 웹 서비스
    - 리소스 : 자원. AWS에서는 컴퓨팅, 스토리지, 네트워크
    - 액세스 : 리소스에 대한 조작 및 제어. CRUD(읽기, 쓰기, 변경, 삭제)
- 사용자가 리소스를 사용하려고 할 때 권한을 세부적으로 조정하는 서비스

---

## 인증 (Authentication)
- 자신이 누구인지 주장할 때 이를 확인하는 절차
- 인증의 주체는 2가지가 존재
  - 사용자
      - id, password를 통해 인증
      - access Key, secret Access Key를 통해 인증
  - Role : 다른 AWS 서비스들이 권한을 부여받고 싶을 때 사용 (일시적)
      - 예) EC2가 S3에 업로드하고 싶다
      - 예) Lambda가 S3에 접근하고 싶다

---

## 권한 부여
- 사용자가 원하는 리소스에 접근하는 것을 허용하는 과정
  - 난 땃쥐인데, ec2 인스턴스를 하나 만들겠습니다. ➔ 아니오아니오
  - 난 땃쥐인데. s3 파일을 다운로드 받을게요. ➔ 네네 
- 권한부여의 주체 : IAM Policy

---

## IAM 그룹
- 공통의 권한을 가지는 사용자의 집합
- 그룹을 생성 후 IAM Policy 연결
- 그룹에 사용자 추가
- 그룹 내 사용자는 그룹과 연결된 Policy의 권한을 부여받음

---

## IAM User
- 그룹의 IAM Policy에 따라 권한을 부여받음
- 사용자에게 직접 Policy를 추가할 수도 있음(다이렉트로)
- IAM User의 인증방식과 사용용도
    - id/pw 방식 : 관리 콘솔에서 사용
    - AccessKey ID/ Secret access key 방식 : CLI, SDK, Web API에서 사용
    - Long term credential 이라고도 함 (비교 : IAM Role은 Short term credential)

---

## IAM Policy

- AWS 관리 정책
    - AWS가 미리 만들어 놓은 정책, 사용자는 편집 불가능
- 사용자 관리 정책
    - 사용자가 직접 생성한 정책
    - 기존 정책으로부터 생성 및 수정 또는 직접 생성 가능
    - GUI 편집기 / JSON 편집기 모두 사용 가능
- 그 외 : 1회성 정책인 Inline 정책도 있다. (재사용 불가)

---

## IAM Policy의 예


```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "*",
            "Resource": "*"
        }
    ]
}
```
Admin의 AccessPolicy
- Version : 버전
- Statment : 실질적 내용
  - effect : 허용(Allow) / 거부(deny)
  - action : "*"(동작)
  - resource : "*"(리소스)

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "NotAction": [
                "iam:*",
                "organizations:*",
                "account:*"
            ],
            "Resource": "*"
        },
        {
            "Effect": "Allow",
            "Action": [
                "iam:CreateServiceLinkedRole",
                "iam:DeleteServiceLinkedRole",
                "iam:ListRoles",
                "organizations:DescribeOrganization",
                "account:ListRegions"
            ],
            "Resource": "*"
        }
    ]
}
```
PowerUserAccess
- NotAction
- Action
- NotAction : "iam:*" - iam에 대해서는 허용하지 않음
- Action : "iam:..." - iam의 ...에 대해서는 허용함
- 문제점 : 자기 자신의 패스워드 변경도 잘 안 됨. 그래서 iam의 일부는 허용함.
